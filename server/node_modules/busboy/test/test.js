'use strict';

const { spawnSync } = require('child_process');
const { readdirSync } = require('fs');
const { join } = require('path');

const files = readdirSync(__dirname).sort();
for (const filename of files) {
  if (filename.startsWith('test-')) {
    const path = join(__dirname, filename);
    if (!require('fs').existsSync(path)) {
      console.error(`File not found: ${path}`);
      continue;
    }
    console.log(`> Running ${filename} ...`);
    try {
      const result = spawnSync('node', ['--', path], {
        stdio: 'inherit',
        windowsHide: true
      });
      if (result.status !== 0) {
        process.exitCode = 1;
      }
    } catch (error) {
      console.error(`Error running ${filename}:`, error);
      process.exitCode = 1;
    }
  }
}

console.log('All tests passed.');

